<html>
<head>
  <title>
    flask analytics
  </title>
  <script>
                        var img = new Image;
                        img.width = img.height = "1px";
                        var res = window.navigator;
                        var data = {};
                        var _plugins = {};
                        Array.prototype.slice.call(navigator.plugins).forEach(function(v, k) {
                          _plugins[v.name.toLowerCase().replace(/\s/, "-")] = {
                            "name": v.name,
                            "description": v.description,
                            "filename": v.filename
                          }
                        });
                        delete res.plugins && delete res.mimeTypes;
                        data.url = window.location.href;
                        data.ref = document.referrer;
                        data.nav = res;
                        data.width = window.screen.width;
                        data.height = window.screen.height;
                        data._plugins = _plugins;
                        data.platform = navigator.platform;
                        data.history = history.length;
                        img.dataset.stats = JSON.stringify(data);
                        console.log(
                          img.dataset.stats
                        );

</script>
<script
 src="https://code.jquery.com/jquery-3.2.1.js"
 integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
 crossorigin="anonymous"></script>
<script>
console.log("sending the data to the flask app")
var server = "http://127.0.0.1:5000";
//console.log("sending the data to the flask app")
var send = {};

function send_img(){
  send = img.dataset.stats;
  console.log('-------hello-------');
}
//console.log("sending the data to the flask app")
$( function() {
    $( "#demo" ).html(function() {
      var appdir='/details';
      var send_msg = "<p>Sending request</p>";
      var received_msg = "<p>Details sent </p>";
      send_img();
      // console.log(received_msg);
      $('#message').html(send_msg);
      $.ajax({
          type: "POST",
          url:server+appdir,
          data: send,
          dataType: 'json'
      }).done(function(data) {
        console.log(data);
        $('#n3').val(data['img']);
        $('#message').html(received_msg);
      });
    });
  });
</script>
</head>
<body>
</body>
<form action="/contact" id="contact-form" method="POST" enctype="text/plain">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
    <div class="row">
        <div class="input-field col s6">
            <input type="text" class="validate" name ="first-name" id="first-name" pattern="[a-zA-Z]*" required/>
            <label for="first-name">First name</label>
            <span class="helper-text" data-error="Only text is accepted." data-success=""></span>
        </div>
        <div class="input-field col s6">
            <input type="text" class="validate" name ="last-name" id="last-name" required/>
            <label for="last-name">Last name</label>
        </div>
    </div>
    <div class="row">
        <div class="input-field col s12">
            <input type="email" class="validate" name ="mail-address" id="mail-address" required/>
            <label for="mail-address">Email</label>
            <span class="helper-text" data-error="Enter your email address here" data-success=""></span>
        </div>
    </div>
    <div class="row">
        <div class="input-field col s12">
            <textarea class="materialize-textarea validate" name ="comment-field" id="comment-field" required></textarea>
            <label for="comment-field">Note</label>
        </div>
    </div>
    <div class="row">
        <div class="input-field col s12">
            <button class="waves-effect waves-light btn" id="contact-form-button" type="submit">submit</button>
        </div>
    </div>
</form>
<div id="form-response"></div>
</html>
