/**
 * @license
 * Copyright (c) 2014, 2019, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * @ignore
 */
define(["ojs/ojcore","jquery","hammerjs","ojs/ojtranslation","ojs/ojcontext","ojs/ojthemeutils","ojs/ojcomponentcore","ojs/ojanimation","ojs/ojmessaging","ojs/ojconverterutils","ojs/ojvalidator-required","ojs/ojlogger","ojs/ojlabelledbyutils","ojs/ojvalidation-error","ojs/ojjquery-hammer","ojs/ojpopup","ojs/ojlabel"],function(e,t,i,s,n,a,o,l,r,u,d,g,p){"use strict";e.EditableValueUtils={},e.EditableValueUtils.validationContext={COMPONENT_CREATE:1,CONVERTER_OPTION_CHANGE:2,DISABLED_OPTION_CHANGE:3,READONLY_OPTION_CHANGE:4,REFRESH_METHOD:5,REQUIRED_OPTION_CHANGE:6,RESET_METHOD:7,USER_ACTION:8,VALIDATE_METHOD:9,VALIDATORS_OPTION_CHANGE:10,VALUE_OPTION_CHANGE:11},e.EditableValueUtils.validateMethodOptions={doValueChangeCheck:!1,validationContext:e.EditableValueUtils.validationContext.VALIDATE_METHOD},e.EditableValueUtils.converterOptionOptions={doValueChangeCheck:!1,doNotClearMessages:!0,validationContext:e.EditableValueUtils.validationContext.CONVERTER_OPTION_CHANGE},e.EditableValueUtils.disabledOptionOptions={doValueChangeCheck:!1,doNotClearMessages:!0,validationContext:e.EditableValueUtils.validationContext.DISABLED_OPTION_CHANGE},e.EditableValueUtils.requiredOptionOptions={doValueChangeCheck:!1,doNotClearMessages:!0,validationContext:e.EditableValueUtils.validationContext.REQUIRED_OPTION_CHANGE},e.EditableValueUtils.readOnlyOptionOptions={doValueChangeCheck:!1,doNotClearMessages:!0,validationContext:e.EditableValueUtils.validationContext.READONLY_OPTION_CHANGE},e.EditableValueUtils.refreshMethodOptions={doValueChangeCheck:!1,doNotClearMessages:!0,validationContext:e.EditableValueUtils.validationContext.REFRESH_METHOD},e.EditableValueUtils.validatorsOptionOptions={doValueChangeCheck:!1,doNotClearMessages:!0,validationContext:e.EditableValueUtils.validationContext.VALIDATORS_OPTION_CHANGE};e.EditableValueUtils.VALIDATE_VALUES={VALID:"valid",INVALID:"invalid"},e.EditableValueUtils.getAttributeValue=function(e,t){var i,s={};if(e&&t){var n=e[0];switch(t){case"disabled":i=n.hasAttribute("disabled")?!!n.disabled:void 0;break;case"pattern":i=n.pattern||void 0;break;case"placeholder":i=n.placeholder||void 0;break;case"readonly":i=n.hasAttribute("readonly")?!!n.readOnly:void 0;break;case"required":if(n.hasAttribute("required")){var a=n.required;i=void 0===a||!!a}else i=void 0;break;case"title":i=n.hasAttribute("title")?n.title:void 0;break;case"value":i=e.val()||void 0;break;case"min":case"max":default:i=n.getAttribute(t)||void 0}}return void 0!==i?(s.fromDom=!0,s.value=i):s.fromDom=!1,s},e.EditableValueUtils.initializeOptionsFromDom=function(t,i,s,n){for(var a={},o=0;o<t.length;o++){var l,r,u=t[o],d=u.attribute,g=u.option||d,p=u.coerceDomValue,h=u.validateOption,_=s.element,c=s.options[g];void 0===i[g]&&(c=s.options[g],(r=e.EditableValueUtils.getAttributeValue(_,d)).fromDom&&(l=r.value,p&&("boolean"==typeof p?l=e.EditableValueUtils.coerceDomValueForOption(g,l):"function"==typeof p&&(l=p.call(s,l))),a[g]=l));var S=g in a?a[g]:c;h&&"boolean"==typeof h&&e.EditableValueUtils.validateValueForOption(g,S)}null!=n&&n(a),s.option(a,{_context:{writeback:!0,internalSet:!0}})},e.EditableValueUtils.validateValueForOption=function(e,t){var i=!1;switch(e){case"required":null!==t&&"boolean"!=typeof t&&(i=!0);break;case"readOnly":case"disabled":null!==t&&"boolean"!=typeof t&&(i=!0)}if(i)throw new Error("Option '"+e+"' has invalid value set: "+t)},e.EditableValueUtils.coerceDomValueForOption=function(e,t){var i=t;switch(e){case"required":i=!!t}return i},e.EditableValueUtils.setPickerAttributes=function(e,t){if(e&&t){var i=t.class;if(i)for(var s=i.split(" "),n=0,a=s.length;n<a;++n)e[0].classList.add(s[n]);var o=t.style;if(o){var l=e[0],r=l.getAttribute("style");r?l.setAttribute("style",r+";"+o):l.setAttribute("style",o)}}},e.EditableValueUtils.hasNoLabelFlag=function(e){return e[0].hasAttribute("data-oj-no-labelledby")},e.EditableValueUtils._getOjLabelAriaLabelledBy=function(t,i){var s,n=e.EditableValueUtils._getCustomOjLabelElements(t);if(n){s="";for(var a=0;a<n.length;a++){var o=n[a],l=o.getAttribute("label-id");if(!l){var r=o.querySelector("label");r?l=r.getAttribute("id"):(o.setAttribute("label-id",i),l=i)}s+=l,a+1<n.length&&(s+=" ")}}return s},e.EditableValueUtils._getCustomOjLabelElements=function(e){var t=[];if(e)for(var i=e.split(/\s+/),s=0;s<i.length;s++){var n=i[s],a=document.getElementById(n);a?t.push(a):g.info("Cannot find oj-label with id "+a)}return t},e.EditableValueUtils._setInputId=function(t,i,s){if(i){e.EditableValueUtils.setSubIdForCustomLabelFor(t,i);var n=e.EditableValueUtils._getCustomOjLabelElements(s);if(n)for(var a=t.id,o=0;o<n.length;o++){n[o].setAttribute("data-oj-input-id",a)}}},e.EditableValueUtils._labelledByChangedForInputComp=function(t,i){var s=e.EditableValueUtils._getCustomOjLabelElements(t);if(s)for(var n=0;n<s.length;n++){s[n].setAttribute("data-oj-input-id",i),this._IsRequired()&&this.options.translations.required&&(this._implicitReqValidator=null,this._getImplicitRequiredValidator())}},e.EditableValueUtils.validate=function(){var e;if(e=this._SetValue(this._GetDisplayValue(),null,this._VALIDATE_METHOD_OPTIONS),this._IsCustomElement()){if(e instanceof Promise)return e.then(function(e){return Promise.resolve(e?"valid":"invalid")});e=Promise.resolve(e?"valid":"invalid")}else if(e instanceof Promise)return e.then(function(e){return Promise.resolve(e?"valid":"invalid")});return e},e.EditableValueUtils.setSubIdForCustomLabelFor=function(e,t){e.setAttribute("id",t+"|input")},e.EditableValueUtils._refreshRequired=function(e){var t,i,s,n=this._AriaRequiredUnsupported();this._refreshTheming("required",e),n||(i=this._GetContentElement(),(s=e)&&i?i[0].setAttribute("aria-required",s):i[0].removeAttribute("aria-required")),this._IsCustomElement()||(this.$label||this._createOjLabel(),this.$label&&(this.$label.ojLabel("option","showRequired",e),n&&(t=this._getAriaLabelledById(this.element))&&(e?this._addAriaDescribedBy(t+"_requiredIcon"):this._removeAriaDescribedBy(t+"_requiredIcon"))))},e.EditableValueUtils._AfterSetOptionRequired=function(t){this._refreshRequired(this._IsRequired()),this._runMixedValidationAfterSetOption(e.EditableValueUtils.requiredOptionOptions)},e.EditableValueUtils._AfterSetOptionValidators=function(){var t;this._ResetAllValidators(),this._hasInvalidMessagesShowing()&&(this._clearComponentMessages(),t=this._GetDisplayValue(),this._SetValue(t,null,e.EditableValueUtils.validatorsOptionOptions))},e.EditableValueUtils._AfterSetOptionAsyncValidators=function(){this._AfterSetOptionValidators()},e.EditableValueUtils._AfterSetOptionConverter=function(){this._converter=null,this._converterChangedCounter+=1;var e=this._GetConverter();if(e instanceof Promise){var t=this;this._setBusyStateAsyncConverterLoading();var i=this._converterChangedCounter;this._loadingConverter(e).then(function(){i===t._converterChangedCounter&&t._ResetConverter(),t._clearBusyStateAsyncConverterLoading()})}else this._ResetConverter()},e.EditableValueUtils._AfterCreateConverterCached=function(){this._HasPlaceholderSet()&&(this._SetPlaceholder(this.options.placeholder),this._customPlaceholderSet=!0),this._initComponentMessaging(this._MESSAGING_CONTENT_UPDATE_TYPE.ALL),this._Refresh("value",this.options.value,!1),this.options.messagesShown.length>0&&this._setMessagesOption("messagesShown",this.options.messagesShown,null,!0)},e.EditableValueUtils._ResetConverter=function(){var t;this._getComponentMessaging().update(this._getMessagingContent(this._MESSAGING_CONTENT_UPDATE_TYPE.CONVERTER_HINT)),this._hasInvalidMessagesShowing()?(this._clearComponentMessages(),t=this._GetDisplayValue(),this._SetValue(t,null,e.EditableValueUtils.converterOptionOptions)):this._Refresh("converter",this.options.converter,!0)},e.EditableValueUtils._GetNormalizedValidatorsFromOption=function(){var t,i,s,n,a,o,l=!0,r=[];if(s=this.options.validators)for(t=0;t<s.length;t++)"object"==typeof(i=s[t])?(i.validate&&"function"==typeof i.validate||(l=!1),l||(o=i.type)&&"string"==typeof o&&(e.Validation&&e.Validation.validatorFactory?a=e.Validation.validatorFactory(o):g.error('oj.Validation.validatorFactory is not available and it is needed to support the deprecated json format for validators property. Please include the backward compatibility "ojvalidation-base" module.'),a&&((n=e.CollectionUtils.copyInto({},i.options)||{}).converter=n.converter||this._GetConverter(),n.label=n.label||this._getLabelText(),i=a.createValidator(n))),r.push(i)):g.error("Unable to parse the validator provided:"+i);return r},e.EditableValueUtils._GetNormalizedAsyncValidatorsFromOption=function(){var e,t,i,s=[];for(i=this.options.asyncValidators,e=0;e<i.length;e++)"object"==typeof(t=i[e])?t.validate&&"function"==typeof t.validate&&s.push(t):g.error("Unable to parse the validator provided:"+t);return s},e.EditableValueUtils._GetConverter=function(){var e,t,i,s=this;if(!this._converter){if((e=this.options.converter)instanceof Promise?i=e:t=u.getConverterInstance(e),i)return i.then(function(e){return s._converter=e,s._converter||null});this._converter=t}return this._converter||null},e.EditableValueUtils._SetBusyState=function(e){void 0===this._resolveBusyStateAsyncMap&&(this._resolveBusyStateAsyncMap=new Map);var t=this._resolveBusyStateAsyncMap.get(e);if(!t){var i=this.element[0],s=n.getContext(i).getBusyContext(),a="The page is waiting for async validators for displayValue "+e;i&&i.id&&(a+=' for "'+i.id+'" '),a+="to finish.",t=s.addBusyState({description:a}),this._resolveBusyStateAsyncMap.set(e,t)}},e.EditableValueUtils._ClearBusyState=function(e){var t;void 0!==this._resolveBusyStateAsyncMap&&(t=this._resolveBusyStateAsyncMap.get(e))&&(t(),this._resolveBusyStateAsyncMap.delete(e))},e.EditableValueUtils._SetBusyStateAsyncValidatorHint=function(e){void 0===this._resolveBusyStateAsyncValidatorHintMap&&(this._resolveBusyStateAsyncValidatorHintMap=new Map);var t=this._resolveBusyStateAsyncValidatorHintMap.get(e);if(!t){var i=this.element[0],s=n.getContext(i).getBusyContext(),a="The page is waiting for async validator hint for counter "+e;i&&i.id&&(a+=' for "'+i.id+'" '),a+="to finish.",t=s.addBusyState({description:a}),this._resolveBusyStateAsyncValidatorHintMap.set(e,t)}},e.EditableValueUtils._ClearBusyStateAsyncValidatorHint=function(e){var t;void 0!==this._resolveBusyStateAsyncValidatorHintMap&&(t=this._resolveBusyStateAsyncValidatorHintMap.get(e))&&(t(),this._resolveBusyStateAsyncValidatorHintMap.delete(e))},e.EditableValueUtils._SetBusyStateAsyncConverterLoading=function(){if(!this._resolveBusyStateAsyncConverterLoading){var e=this.element[0],t=n.getContext(e).getBusyContext(),i="The page is waiting for async converter loading ";e&&e.id&&(i+='for "'+e.id+'" '),i+="to finish.",this._resolveBusyStateAsyncConverterLoading=t.addBusyState({description:i})}},e.EditableValueUtils._ClearBusyStateAsyncConverterLoading=function(){void 0!==this._resolveBusyStateAsyncConverterLoading&&(this._resolveBusyStateAsyncConverterLoading(),delete this._resolveBusyStateAsyncConverterLoading)},e.EditableValueUtils._getShowLoadingDelay=function(){null==this._defaultOptions&&(this._defaultOptions=a.parseJSONFromFontFamily("oj-form-control-option-defaults"));var e=parseInt(this._defaultOptions.showIndicatorDelay,10);return isNaN(e)?0:e},e.EditableValueUtils._SetInputType=function(t){var i="text",s=e.AgentUtils.getAgentInfo();if(s.os===e.AgentUtils.OS.ANDROID||s.os===e.AgentUtils.OS.IOS||s.os===e.AgentUtils.OS.WINDOWSPHONE)if(t.indexOf(this.options.virtualKeyboard)>=0)i=this.options.virtualKeyboard;else{var n=this._GetConverter();if(n&&n.resolvedOptions){var a=n.resolvedOptions();t.indexOf(a.virtualKeyboardHint)>=0&&(i=a.virtualKeyboardHint)}}null==i?this.element[0].removeAttribute("type"):this.element[0].setAttribute("type",i)};var h="invalidShown";e.__registerWidget("oj.editableValue",t.oj.baseComponent,{widgetEventPrefix:"oj",options:{describedBy:null,disabled:!1,displayOptions:{},help:void 0,helpHints:{definition:"",source:""},labelHint:"",labelEdge:void 0,messagesCustom:[],messagesHidden:void 0,messagesShown:void 0,title:"",valid:void 0,value:void 0,animateStart:null,animateEnd:null},getNodeBySubId:function(e){var t;if(!(t=this._super(e))&&!this._IsCustomElement()&&"oj-label-help-icon"===e.subId){var i=this._GetLabelElement();i&&(t=i.parent().find(".oj-label-help-icon"))}return t||null},getSubIdByNode:function(e){var i,s,n,a=null;return null!=e&&null!=(i=t(e).closest("a.oj-label-help-icon"))&&null!=(s=i.closest(".oj-label"))&&(n=s.find("label")[0])&&n===this._GetLabelElement()[0]&&(a={subId:"oj-label-help-icon"}),a},isValid:function(){return void 0===this._valid&&(this._valid=!this._hasInvalidMessages()),this._valid},refresh:function(){this._super(),this._doRefresh()},reset:function(){this._clearAllMessages(),this._runDeferredValidation(this._VALIDATION_CONTEXT.RESET_METHOD),this._refreshComponentDisplayValue(this.options.value,!0)},showMessages:function(){var t,i,s,n=[],a=this.options.messagesHidden,o=a.length>0;for(t=0;t<a.length;t++)(i=a[t])instanceof e.ComponentMessage?(i._forceDisplayToShown(),s=i.clone()):s=new r(i.summary,i.detail,i.severity),n.push(s);o&&(this._clearMessages("messagesHidden"),this._updateMessagesOption("messagesShown",n),this._setValidOption(h,null))},_VALIDATION_MODE:{FULL:1,VALIDATORS_ONLY:2,REQUIRED_VALIDATOR_ONLY:3},_VALIDATION_CONTEXT:e.EditableValueUtils.validationContext,_VALIDATE_METHOD_OPTIONS:e.EditableValueUtils.validateMethodOptions,_InitOptions:function(e,t){this._super(e,t)},_ComponentCreate:function(){var e=this.element,t=this._GetSavedAttributes(e);if(this._super(),this.options.messagesCustom=this.options.messagesCustom||[],this.options.messagesHidden=[],this.options.messagesShown=this.options.messagesCustom.length>0?this._cloneMessagesBeforeSet(this.options.messagesCustom):[],this._SetDisabledDom(e),t&&!this._IsCustomElement()){var i=e[0].tagName.toLowerCase();"input"!==i&&"textarea"!==i||["required","title","pattern"].forEach(function(i){i in t&&e.removeAttr(i)})}},_AfterCreate:function(){var t,i,s=this;if(this._super(),this._refreshTheming("disabled",this.options.disabled),this.widget()[0].classList.add("oj-form-control"),this._IsTextFieldComponent()&&(this._IsCustomElement()?this._getRootElement().classList.add("oj-text-field"):this.widget()[0].classList.add("oj-text-field")),this.widget().uniqueId(),this._IsCustomElement())if(this.options.labelledBy){var n=e.EditableValueUtils._getCustomOjLabelElements(this.options.labelledBy);if(n)for(i=0;i<n.length;i++){n[i].classList.add(this._GetDefaultStyleClass()+"-label")}}else this._setAriaLabelFromLabelHint();else this._createOjLabel();if(t=this.options.describedBy){var a=t.split(/\s+/);for(i=0;i<a.length;i++)this._addAriaDescribedBy(a[i])}this._runDeferredValidation(this._VALIDATION_CONTEXT.COMPONENT_CREATE);var o=this._GetConverter();this._converterChangedCounter=0,o instanceof Promise?(this._setBusyStateAsyncConverterLoading(),this._ResolveLabelEdgeStrategyType(),this._loadingConverter(o).then(function(){s._AfterCreateConverterCached(),s._clearBusyStateAsyncConverterLoading()})):(this._AfterCreateConverterCached(),this._setValidOption(this._determineValidFromMessagesOptions(),null))},_SaveAttributes:function(e){this._IsCustomElement()||this._SaveAllAttributes(e)},_RestoreAttributes:function(e){this._IsCustomElement()||this._RestoreAllAttributes(e)},_AfterSetOption:function(t,i){switch(t){case"disabled":this._AfterSetOptionDisabledReadOnly(t,e.EditableValueUtils.disabledOptionOptions);break;case"displayOptions":this._initComponentMessaging();break;case"labelEdge":this._initComponentMessaging(),this._setAriaLabelFromLabelHint();break;case"labelHint":this._setAriaLabelFromLabelHint();break;case"help":this._IsCustomElement()?this._getComponentMessaging().update(this._getMessagingContent(this._MESSAGING_CONTENT_UPDATE_TYPE.TITLE)):this._Refresh(t,this.options[t]);break;case"messagesCustom":this._messagesCustomOptionChanged(i),this._setValidOption(this._determineValidFromMessagesOptions(),null);break;case"placeholder":this._placeholderOptionChanged(i);break;case"title":this._IsCustomElement()||this._getComponentMessaging().update(this._getMessagingContent(this._MESSAGING_CONTENT_UPDATE_TYPE.TITLE));break;case"translations":this.refresh();break;case"value":this._AfterSetOptionValue(t,i)}},_AfterSetOptionDisabledReadOnly:function(e,t){var i=!this.options[e];this._Refresh(e,this.options[e]),i&&this._runMixedValidationAfterSetOption(t)},_AfterSetOptionValue:function(e,t){var i,s=t?t._context:null,n=!1;s&&(n=!!s.originalEvent,i=s.doNotClearMessages||!1),n||(i||this._clearAllMessages(null),this._runDeferredValidation(this._VALIDATION_CONTEXT.VALUE_OPTION_CHANGE)),this._Refresh(e,this.options[e],!0)},_CanSetValue:function(){return!(this.options.disabled||!1)},_destroy:function(){var e,i,s=this._super();if(this._clearAllMessages(null,!0),this.widget().removeUniqueId(),this._getComponentMessaging()._isActive()&&this._getComponentMessaging().deactivate(),this.$label)for(i=this.$label.length,e=0;e<i;e++)this.$label[e]&&null!=o.__GetWidgetConstructor(this.$label[e])&&t(this.$label[e]).ojLabel("destroy");return s},GetFocusElement:function(){return this._GetContentElement()[0]},_setOption:function(t,i,s){var n,a,o,l,r=!1;switch(t){case"messagesHidden":case"messagesShown":case"rawValue":r=!0;break;case"describedBy":a=this.options.describedBy,o=i,this._updateDescribedBy(a,o);break;case"labelledBy":if(i){var u=e.EditableValueUtils._getCustomOjLabelElements(i);if(u)for(l=0;l<u.length;l++){u[l].classList.add(this._GetDefaultStyleClass()+"-label")}}}return r?(g.error(t+" option cannot be set"),this):(n=this._superApply(arguments),this._AfterSetOption(t,s),n)},_GetContentElement:function(){return this.element},_GetLabelElement:function(){var i;if(this.$label)return this.$label;if(e.EditableValueUtils.hasNoLabelFlag(this.widget()))return null;var s=this._getAriaLabelledByElement(this.element);if(null!==s&&0!==s.length)return s;var n=this.element[0].id;return void 0!==n&&0!==(s=t("label[for='"+n+"']")).length?s:0!==(i=this.element.closest("[aria-labelledby]")).length&&null!==(s=this._getAriaLabelledByElement(i))&&0!==s.length?s:null},_GetElementValue:function(){return this.element.val()},_GetMessagingLauncherElement:function(){return this._GetContentElement()},_GetConverter:function(){return null},_GetImplicitValidators:function(){return this._implicitSyncValidators||(this._implicitSyncValidators={}),this._implicitSyncValidators},_GetDisplayValue:function(e){return this._GetContentElement().val()},_GetNormalizedValidatorsFromOption:function(){return[]},_GetNormalizedAsyncValidatorsFromOption:function(){return[]},_GetAllValidatorsFromValidatorsOptionAndImplicit:function(){var e,t,i,s,n=[];if(!this._allValidators){t=this._GetImplicitValidators(),i=[];var a,o=Object.keys(t),l=o.length;if(l>0){for(e=0;e<l;e++)a=o[e],i.push(t[a]);n=n.concat(i)}(s=this._GetNormalizedValidatorsFromOption()).length>0&&s.forEach(function(e){n.push(e)}),this._allValidators=n}return this._allValidators},_ResetAllValidators:function(){this._initAsyncMessaging=null,this._allValidators&&(this._allValidators.length=0),this._allValidators=null,this._IsCustomElement()?this._updateValidatorMessagingHint():this._getComponentMessaging().update(this._getMessagingContent(this._MESSAGING_CONTENT_UPDATE_TYPE.VALIDATOR_HINTS))},_GetAriaLabelElement:function(){return this._getRootElement()},_setAriaLabelFromLabelHint:function(){if(this._IsCustomElement()){var e=this._GetAriaLabelElement(),t=e.getAttribute("aria-label");this.options.labelledBy||!this.options.labelHint||"none"!==this.options.labelEdge||t&&t!==this._ariaLabelFromHint||this._getRootElement().getAttribute("aria-labelledby")?this._ariaLabelFromHint&&this._ariaLabelFromHint===t&&e.removeAttribute("aria-label"):(e.setAttribute("aria-label",this.options.labelHint),this._ariaLabelFromHint=this.options.labelHint)}},_getAllAsyncValidatorsWithHint:function(){var e,t,i=this._GetNormalizedAsyncValidatorsFromOption(),s=[];if(this._IsRequired()&&"hint"in(t=this._getImplicitRequiredValidator())&&s.push(t),i.length>0)for(e=0;e<i.length;e++)"hint"in(t=i[e])&&s.push(t);var n=this._GetAllValidatorsFromValidatorsOptionAndImplicit();if(n.length>0)for(e=0;e<n.length;e++)"hint"in(t=n[e])&&s.push(t);return s},_initAsyncValidatorMessagingHint:function(){var e,t,i=this._getAllAsyncValidatorsWithHint(),s=this;this._asyncValidatorHintCounter=0,i.length>0&&(t=s._getMessagingContent(s._MESSAGING_CONTENT_UPDATE_TYPE.VALIDATOR_HINTS),e=this._asyncValidatorHintCounter,this._setBusyStateAsyncValidatorHint(e),this._addAsyncValidatorsHintsMessagingContent(i,t).then(function(){s._clearBusyStateAsyncValidatorHint(e)}))},_updateValidatorMessagingHint:function(){var e,t=this._getAllAsyncValidatorsWithHint(),i=this._getComponentMessaging(),s=this,n=this._getMessagingContent(this._MESSAGING_CONTENT_UPDATE_TYPE.VALIDATOR_HINTS);t.length>0?(this._asyncValidatorHintCounter+=1,e=this._asyncValidatorHintCounter,this._setBusyStateAsyncValidatorHint(e),this._addAsyncValidatorsHintsMessagingContent(t,n).then(function(){s._clearBusyStateAsyncValidatorHint(e)})):i.update(n)},_addAsyncValidatorsHintsMessagingContent:function(e,t){var i,s=this._asyncValidatorHintCounter,n=this._getComponentMessaging(),a=[],o=this,l=[];for(i=0;i<e.length;i++)l.push(e[i].hint);function r(e){return e.then(function(e){var i,l={};return o._asyncValidatorHintCounter===s?(null!==e&&(a.push(e),l.validatorHint=t.validatorHint.concat(a),n.update(l)),i="resolved"):i="ignore",{v:e,status:i}},function(e){return{e:e,status:"rejected"}})}return new Promise(function(e){Promise.all(l.map(r)).then(function(){e(a)})})},_IsRequired:function(){return!1},_HandleChangeEvent:function(e){var t=this._GetDisplayValue();this._SetValue(t,e)},_SetRawValue:function(e,t){var i={};i._context={originalEvent:t,writeback:!0,internalSet:!0,readOnly:!0},this._CompareOptionValues("rawValue",this.options.rawValue,e)||this.option("rawValue",e,i)},_Refresh:function(e,t,i){var s,n;switch(e){case"converter":var a=this.options.value;this._refreshComponentDisplayValue(a,i);break;case"disabled":this._refreshTheming("disabled",this.options.disabled);break;case"help":this._IsCustomElement()||this.$label&&(s=this.options.help.definition,n=this.options.help.source,this.$label.ojLabel("option","help",{definition:s,source:n}),this._refreshDescribedByForLabel());break;case"value":this._refreshComponentDisplayValue(t,i)}},_NotifyHidden:function(){this._superApply(arguments),this._getComponentMessaging().close()},_NotifyDetached:function(){this._superApply(arguments),this._getComponentMessaging().close()},_ResetComponentState:function(){this.$label&&this.$label.ojLabel("refresh"),this._implicitReqValidator=null,this._converter=null,this._ResetAllValidators()},_SetDisplayValue:function(e){var t=this._GetContentElement();t.val()!==e&&t.val(e)},_SetDisabledDom:function(e){"boolean"==typeof this.options.disabled&&(e[0].disabled=this.options.disabled)},_SetPlaceholder:function(e){var t=this._GetContentElement()[0];t&&(null==e?t.removeAttribute("placeholder"):t.setAttribute("placeholder",e))},_SetPlaceholderOption:function(e){this.options.placeholder=e},_HasPlaceholderSet:function(){return this.options.placeholder},_ClearPlaceholder:function(){this._SetPlaceholderOption(""),this._SetPlaceholder("")},_SetValue:function(e,t,i){var s,n,a,o=!i||"boolean"!=typeof i.doValueChangeCheck||i.doValueChangeCheck,l=this,r=!1;return void 0===e?(g.warn("Attempt to set a value of undefined"),!1):(o&&e===l._getLastDisplayValue()?g.level>g.LEVEL_WARN&&g.info((e.toString,e.toString())):(s=e+"_"+(this._asyncValidatorValidateCounter+1),(n=this._AsyncValidate(e,t,i,s))instanceof Promise?r=n.then(function(e){return a=e,l._afterAsyncValidateUpdateValue(e,t,i)}).then(function(){return l._clearBusyState(s),void 0!==a}):(this._afterAsyncValidateUpdateValue(n,t,i),r=void 0!==n)),r)},_ParseValueShowErrors:function(e,t){var i;this._clearAllMessages(t);try{return this._parseValue(e,t)}catch(e){i=this._processValidationErrors(e),this._updateMessagesOption("messagesShown",i,t),this._setValidOption(h,t)}},_AsyncValidate:function(e,t,i,s){var n,a,o,l=i&&i.validationMode?i.validationMode:this._VALIDATION_MODE.FULL,r=i&&i.validationContext?i.validationContext:this._VALIDATION_CONTEXT.USER_ACTION,u=i&&i.doNotClearMessages||!1;if(void 0!==e){if(this._CanSetValue()){u||this._clearAllMessages(t);try{return this._asyncValidatorValidateCounter+=1,l===this._VALIDATION_MODE.FULL?(this._setLastDisplayValue(e),a=this._parseValue(e,t,!0)):a=e,(o=this._asyncValidateValue(a,t,r))instanceof Promise?(this._setBusyState(s),o.then(function(e){if("valid"===e)return a})):o}catch(e){n=this._processValidationErrors(e,r),this._updateMessagesOption("messagesShown",n,t),this._setValidOption(h,t)}}else g.level>g.LEVEL_WARN&&g.info("Validation skipped and value option not set as component state does not  allow setting value. For example if the component is readonly or disabled.");return o}g.warn("Attempt to set a value of undefined")},_afterAsyncValidateUpdateValue:function(e,t,i){var s,n=!1;return void 0!==e&&(i&&!0===i.doNotClearMessages?this.isValid()||!this._hasInvalidComponentMessagesShowing():this.isValid())&&(i&&i._context&&(s=i._context),this._updateValueOption(e,t,i&&i.validationContext,s,i),n=!0),n},_CompareOptionValues:function(t,i,s){return"value"===t||"rawValue"===t?e.Object.compareValues(i,s):0===t.indexOf("messages")?this._messagesEquals(i,s):this._superApply(arguments)},_GetDefaultStyleClass:function(){return e.Assert.failedInAbstractFunction(),""},_MESSAGING_CONTENT_UPDATE_TYPE:{ALL:1,VALIDITY_STATE:2,CONVERTER_HINT:3,VALIDATOR_HINTS:4,TITLE:5},_OPTION_TO_CSS_MAPPING:{disabled:"oj-disabled",required:"oj-required"},_clearAllMessages:function(e,t){t?(this.options.messagesHidden=[],this.options.messagesShown=[],this.options.messagesCustom=[]):(this._clearMessages("messagesHidden",e),this._clearMessages("messagesShown",e),this._clearMessages("messagesCustom",e))},_clearComponentMessages:function(){var t,i=this.options.messagesShown;t=i.length,this._clearMessages("messagesHidden");for(var s=t-1;s>=0;s--)i[s]instanceof e.ComponentMessage&&i.splice(s,1);i.length!==t&&this._setMessagesOption("messagesShown",i,null,!0)},_setMessagesOption:function(e,t,i,s){var n={},a=0===t.length&&0===this.options[e].length;!s&&a||(n._context={originalEvent:i,writeback:!0,internalSet:!0},"messagesCustom"!==e&&(n._context.readOnly=!0),n.changed=s||!a,this._resetValid(),this.option(e,t,n),this._updateMessagingContent())},_setValidOption:function(e,t){var i={};"pending"===e&&"valid"!==this._determineValidFromMessagesOptions()||(i._context={originalEvent:t,writeback:!0,internalSet:!0,readOnly:!0},this.option("valid",e,i))},_clearMessages:function(e,t){this._setMessagesOption(e,[],t)},_cloneMessagesBeforeSet:function(e){var t,i,s,n=[];if(e&&e.length>0)for(t=0;t<e.length;t++)s=e[t],i=new r(s.summary,s.detail,s.severity),i=Object.freeze?Object.freeze(i):i,n.push(i);return n},_createOjLabel:function(){var e,t;this._IsCustomElement()||(this.$label=this._GetLabelElement(),this.$label&&(e=this.options.help.definition,t=this.options.help.source,this.$label.ojLabel({rootAttributes:{class:this._GetDefaultStyleClass()+"-label"},help:{definition:e,source:t}}),this._createDescribedByForLabel()))},_createDescribedByForLabel:function(){var e,t=this.options.help.definition;if(null!=this.options.help.source||null!=t){var i=this.$label[0];i&&(e=i.id),e&&this._addAriaDescribedBy(e+"_helpIcon")}},_refreshDescribedByForLabel:function(){var e,t=this.options.help.definition,i=this.options.help.source,s=this.$label[0];s&&(e=s.id),e&&(null!=i||null!=t?this._addAriaDescribedBy(e+"_helpIcon"):this._removeAriaDescribedBy(e+"_helpIcon"))},_doRefresh:function(){var t,i=!1;this._ResetComponentState(),this._initComponentMessaging(),this._Refresh("disabled",this.options.disabled),this._hasInvalidMessagesShowing()&&(i=!0),this._clearComponentMessages(),i?(t=this._GetDisplayValue(),this._SetValue(t,null,e.EditableValueUtils.refreshMethodOptions)):(this._IsRequired()&&this._runDeferredValidation(e.EditableValueUtils.refreshMethodOptions.validationContext),this._Refresh("value",this.options.value,!0))},_getLastModelValue:function(){return this._oj_lastModelValue},_getLastDisplayValue:function(){return void 0===this._oj_lastElementValue&&(this._oj_lastElementValue=""),this._oj_lastElementValue},_getAriaLabelledByElement:function(e){var i=e[0].getAttribute("aria-labelledby");return void 0!==i?t("label[id='"+i+"']"):null},_getAriaLabelledById:function(e){var t=null,i=this._getAriaLabelledByElement(e);return null!==i&&0!==i.length&&(t=i[0].getAttribute("id")),t},_getMessages:function(){var e=[];return this.options.messagesShown&&(e=e.concat(this.options.messagesShown)),this.options.messagesHidden&&(e=e.concat(this.options.messagesHidden)),e},_getLabelText:function(){if(this.$label)return this.$label[0].textContent;var t=e.EditableValueUtils._getCustomOjLabelElements(this.options.labelledBy),i=null;if(t)for(var s=0;s<t.length;s++){s>0&&(i+=" "),i=t[s].textContent}return i},_getValidityState:function(){return this._validityState?this._validityState:(this._validityState=new e.ComponentValidity(this.isValid(),this._getMessages()),this._validityState)},_hasInvalidMessages:function(){return!r.isValid(this._getMessages())},_hasInvalidMessagesShowing:function(){return!this.isValid()&&this.options.messagesShown.length>0},_hasInvalidComponentMessagesShowing:function(){for(var t,i,s=this.options.messagesShown,n=0;n<s.length;n++)(i=s[n])instanceof e.ComponentMessage&&i._isMessageAddedByComponent()&&(t=t||[]).push(i);return void 0!==t&&!r.isValid(t)},_initComponentMessaging:function(){var e=this._getComponentMessaging(),t=this._GetMessagingLauncherElement(),i=this._GetContentElement(),s=this._getMessagingContent(this._MESSAGING_CONTENT_UPDATE_TYPE.ALL);this._customPlaceholderSet||this._ClearPlaceholder(),e.activate(t,i,s),this._asyncValidatorValidateCounter=0},_messagesCustomOptionChanged:function(t){var i,s,n=t?t._context:null,a=this.options.messagesCustom,o=this.options.messagesShown,l=[];for(i=0;i<o.length;i++)(s=o[i])instanceof e.ComponentMessage&&s._isMessageAddedByComponent()&&l.push(s);for(i=0;i<a.length;i++)l.push(a[i]);this._setMessagesOption("messagesShown",l,n?n.originalEvent:null,t&&t.changed)},_placeholderOptionChanged:function(e){var t=!(e&&e._context||{}).internalMessagingSet,i=this.options.placeholder;this._SetPlaceholder(i),t?(this._customPlaceholderSet=!0,this._GetConverter()&&this._initComponentMessaging()):this._customPlaceholderSet=!1},_setLastModelValue:function(e){this._oj_lastModelValue=e},_setLastDisplayValue:function(e){this._oj_lastElementValue=e},_updateMessagesOption:function(e,t,i){var s,n,a;if("object"==typeof t&&Array.isArray(t))for(a=this.options[e],n=t.length,s=0;s<n;s++)a.push(t[s]);this._setMessagesOption(e,a,i,!0)},_updateMessagingContent:function(){this._getComponentMessaging().update(this._getMessagingContent(this._MESSAGING_CONTENT_UPDATE_TYPE.VALIDITY_STATE))},_updateValueOption:function(e,t,i,s,n){var a,o,l=s||{};switch(t&&(l.originalEvent=t),i){case this._VALIDATION_CONTEXT.CONVERTER_OPTION_CHANGE:case this._VALIDATION_CONTEXT.DISABLED_OPTION_CHANGE:case this._VALIDATION_CONTEXT.READONLY_OPTION_CHANGE:case this._VALIDATION_CONTEXT.REFRESH_METHOD:case this._VALIDATION_CONTEXT.REQUIRED_OPTION_CHANGE:case this._VALIDATION_CONTEXT.VALIDATE_METHOD:case this._VALIDATION_CONTEXT.VALIDATORS_OPTION_CHANGE:l.writeback=!0,l.doNotClearMessages=!0}if(l.internalSet=!0,n&&n.targetOptions){a={},o=!1;for(var r=0;r<n.targetOptions.length;r++)a[n.targetOptions[r]]=e,o=o||"value"===n.targetOptions[r]}else a={value:e},o=!0;this.option(a,{_context:l}),o&&this._AfterSetOptionValue("value",{_context:l})},_resetValid:function(){this._valid=void 0},_determineValidFromMessagesOptions:function(){var e=this.options.messagesHidden,t=this.options.messagesShown,i="valid";return t&&0!==t.length&&!r.isValid(t)?i=h:e&&0!==e.length&&!r.isValid(e)&&(i="invalidHidden"),i},_formatValue:function(e){var t=e,i=this._GetConverter();return i&&"object"==typeof i&&(i.format&&"function"==typeof i.format?t=i.format(e):g.level>g.LEVEL_WARN&&g.info("converter does not support the format method.")),t},_getComponentMessaging:function(){return this._componentMessaging||(this._componentMessaging=new e.ComponentMessaging(this)),this._componentMessaging},_getHintsFromAllValidatorsWithGetHintFunction:function(e){var t,i,s=[],n="";for(this._IsRequired()&&(i=this._getImplicitRequiredValidator()).getHint&&"function"==typeof i.getHint&&(n=i.getHint())&&s.push(n),t=0;t<e.length;t++)n="","object"==typeof(i=e[t])&&i.getHint&&"function"==typeof i.getHint&&(n=i.getHint())&&s.push(n);return s},_getImplicitRequiredValidator:function(){var e,t={};return null==this._implicitReqValidator&&(e={hint:(t=this.options.translations&&this.options.translations.required||{}).hint||null,label:this._getLabelText(),messageSummary:t.messageSummary||null,messageDetail:t.messageDetail||null},this._implicitReqValidator=new d(e)),this._implicitReqValidator},_getMessagingContent:function(e){var t,i,s,n={},a="",o=[];if((e=e||this._MESSAGING_CONTENT_UPDATE_TYPE.VALIDITY_STATE)!==this._MESSAGING_CONTENT_UPDATE_TYPE.ALL&&e!==this._MESSAGING_CONTENT_UPDATE_TYPE.VALIDITY_STATE||(s=this._getMessages(),this._getValidityState().update(this.isValid(),s),n.validityState=this._getValidityState()),e!==this._MESSAGING_CONTENT_UPDATE_TYPE.ALL&&e!==this._MESSAGING_CONTENT_UPDATE_TYPE.CONVERTER_HINT||((i=this._GetConverter())&&"object"==typeof i&&i.getHint&&"function"==typeof i.getHint&&(a=i.getHint()||""),n.converterHint=a),e!==this._MESSAGING_CONTENT_UPDATE_TYPE.ALL&&e!==this._MESSAGING_CONTENT_UPDATE_TYPE.VALIDATOR_HINTS||(t=this._GetAllValidatorsFromValidatorsOptionAndImplicit(),o=this._getHintsFromAllValidatorsWithGetHintFunction(t)||[],n.validatorHint=o),e===this._MESSAGING_CONTENT_UPDATE_TYPE.ALL||e===this._MESSAGING_CONTENT_UPDATE_TYPE.TITLE){var l;if(this._IsCustomElement()){var r=this.options.help;null!=r&&(l=r.instruction)}else l=this.options.title;n.title=l||""}return n},_messagesEquals:function(e,i){var s,n=-1,a=!0,o=t.extend([],e),l=t.extend([],i);return o.length===l.length&&(o.forEach(function(e){e instanceof r?s=e:(s=new r(e.summary,e.detail,e.severity),s=Object.freeze?Object.freeze(s):s),n=-1,l.forEach(function(e,t){r.getSeverityLevel(s.severity)===r.getSeverityLevel(e.severity)&&s.summary===e.summary&&s.detail===e.detail&&(n=t)}),n>-1?l.splice(n,1):a=!1}),a)},_parseValue:function(e,t,i){var s=this._GetConverter(),n=e;if(s&&"object"==typeof s)if(s.parse&&"function"==typeof s.parse)try{i&&this._setValidOption("pending",t),n=s.parse(e)}catch(e){throw e}else g.level>g.LEVEL_WARN&&g.info("converter does not support the parse method.");return n},_addValidationError:function(t,i){var n,a,o,l;t instanceof e.ConverterError||t instanceof e.ValidatorError?(a=(o=t.getMessage()).severity||r.SEVERITY_LEVEL.ERROR,l=o.summary||s.getTranslatedString("oj-message.error"),n=o.detail||s.getTranslatedString("oj-converter.detail")):t.summary||t.detail?(a=r.SEVERITY_LEVEL.ERROR,l=t.summary||s.getTranslatedString("oj-message.error"),n=t.detail||s.getTranslatedString("oj-converter.detail")):(a=r.SEVERITY_LEVEL.ERROR,l=s.getTranslatedString("oj-message.error"),n=t.message||s.getTranslatedString("oj-converter.detail")),i.push({summary:l,detail:n,severity:a})},_processValidationErrors:function(t,i,s){var n,a=[],o=t._messages||[],l={};l.context=i||0,l.display=s||e.ComponentMessage.DISPLAY.SHOWN,0===o.length&&this._addValidationError(t,o);for(var r=0;r<o.length;r++)n=o[r],a.push(this._createComponentMessage(n.summary,n.detail,n.severity,l));return a||null},_createComponentMessage:function(t,i,s,n){var a;return a=new e.ComponentMessage(t,i,s,n),a=Object.seal?Object.seal(a):a},_refreshComponentDisplayValue:function(e,t){var i;return(t||e!==this._getLastModelValue())&&(i=this._UpdateElementDisplayValue(e)),i},_refreshTheming:function(e,t){-1!==Object.keys(this._OPTION_TO_CSS_MAPPING).indexOf(e)&&(t?this.widget()[0].classList.add(this._OPTION_TO_CSS_MAPPING[e]):this.widget()[0].classList.remove(this._OPTION_TO_CSS_MAPPING[e]))},_runDeferredValidation:function(e){var t=this;if(this._CanSetValue()){if(!this._resolveBusyStateDeferredValidation){var i=this.element[0],s=n.getContext(i).getBusyContext(),a="The page is waiting for async deferred validation ";i&&i.id&&(a+='for "'+i.id+'" '),a+="to finish.",this._resolveBusyStateDeferredValidation=s.addBusyState({description:a})}var o=this._validateValueForRequiredOnly(this.options.value,e);if(!(o instanceof Promise))return this._setValidOption(this._determineValidFromMessagesOptions(),null),void(this._resolveBusyStateDeferredValidation&&(this._resolveBusyStateDeferredValidation(),delete this._resolveBusyStateDeferredValidation));o.then(function(){t._resolveBusyStateDeferredValidation&&(t._resolveBusyStateDeferredValidation(),delete t._resolveBusyStateDeferredValidation),t._setValidOption(t._determineValidFromMessagesOptions(),null)})}else g.level>g.LEVEL_WARN&&g.info("Deferred validation skipped as component is readonly or disabled.");this._setValidOption(this._determineValidFromMessagesOptions(),null)},_runMixedValidationAfterSetOption:function(e){var t,i=!1;this._hasInvalidMessagesShowing()&&(i=!0),this._clearComponentMessages(),i&&(t=this._GetDisplayValue(),this._SetValue(t,null,e)),!i&&this._IsRequired()?this._runDeferredValidation(e.validationContext):this._setValidOption(this._determineValidFromMessagesOptions(),null)},_UpdateElementDisplayValue:function(e,t){var i,s;i=e;try{i=this._formatValue(e);try{this._setLastModelValue(e),this._afterConverterFormat(i)}catch(e){throw e}s=i}catch(n){t||this._afterConverterFormatFailure(n),this._setLastModelValue(e),this._afterConverterFormat(i),s=void 0}return s},_SetLoading:function(){var e=this.widget()[0],t=this.GetFocusElement();e.classList.add("oj-loading"),this._saveAriaLabel=t.getAttribute("aria-label");var i=s.getTranslatedString("oj-ojEditableValue.loading");t.setAttribute("aria-label",i)},_ClearLoading:function(){var e=this.widget()[0],t=this.GetFocusElement();e.classList.remove("oj-loading"),this._saveAriaLabel?t.setAttribute("aria-label",this._saveAriaLabel):t.removeAttribute("aria-label")},_afterConverterFormat:function(e){var t;this._SetDisplayValue(e),t=this._GetDisplayValue(),this._setLastDisplayValue(t),this._SetRawValue(t,null)},_afterConverterFormatFailure:function(e){var t;t=this._processValidationErrors(e),this._updateMessagesOption("messagesShown",t),this._setValidOption(h,null)},_loadingConverter:function(t){var i=this,s=e.EditableValueUtils._getShowLoadingDelay(),n=this._converterChangedCounter,a=setTimeout(function(){n===i._converterChangedCounter&&i._SetLoading()},s);return t.then(function(e){return i._ClearLoading(),clearTimeout(a),e})},_validateValueForRequiredOnly:function(t,i){var s,n,a=this;if(this._IsRequired()){n=this._getImplicitRequiredValidator();try{this._setValidOption("pending",null);var o=n.validate(e.StringUtils.trim(t));if(o instanceof Promise)return o.then(function(){},function(t){(s=a._processValidationErrors(t,i,e.ComponentMessage.DISPLAY.HIDDEN))&&a._updateMessagesOption("messagesHidden",s)})}catch(t){(s=this._processValidationErrors(t,i,e.ComponentMessage.DISPLAY.HIDDEN))&&this._updateMessagesOption("messagesHidden",s)}}return null},_asyncValidateValue:function(t,i,s){var n,a,o,l,r,u=this._GetNormalizedAsyncValidatorsFromOption(),d=this._GetAllValidatorsFromValidatorsOptionAndImplicit(),p=!1,_=this,c=[],S=this._asyncValidatorValidateCounter,m=[],v=this._IsRequired();if(v&&(l=this._getImplicitRequiredValidator()),(v||u.length>0||d.length>0)&&this._setValidOption("pending",i),l)try{var E=l.validate(e.StringUtils.trim(t));E&&m.push(E)}catch(e){this._addValidationError(e,c),this._setValidOption(h,i),p=!0}for(n=0;n<u.length;n++){try{r=u[n].validate(t)}catch(e){r=Promise.reject(e)}r instanceof Promise||(r=Promise.resolve(r)),m.push(r)}for(n=0;n<d.length;n++)try{(r=d[n].validate(t))instanceof Promise&&m.push(r)}catch(e){this._addValidationError(e,c),this._setValidOption(h,i),p=!0}if(c.length>0){let e=new Error;e._messages=c,o=this._processValidationErrors(e,s),this._updateMessagesOption("messagesShown",o,i)}function y(e){return e.then(function(e){var i;return _._asyncValidatorValidateCounter===S?i="resolved":(g.level>g.LEVEL_WARN&&g.info("Validate ignored because new value came in before async validator finished for "+t),i="ignore"),{v:e,status:i}},function(e){var n;return _._asyncValidatorValidateCounter===S?(o=_._processValidationErrors(e,s),_._updateMessagesOption("messagesShown",o,i),p||(_._setValidOption(h,i),p=!0),n="rejected"):(g.level>g.LEVEL_WARN&&g.info("Validate ignored because new value came in before async validator finished for "+t),n="ignore"),{e:e,status:n}})}return m.length>0?new Promise(function(e){Promise.all(m.map(y)).then(function(t){t.filter(function(e){return"ignore"===e.status}).length>0?a="ignoreValidation":(a=p?h:"valid",_._setValidOption(_._determineValidFromMessagesOptions(),i)),e(a)})}):(0===c.length&&this._setValidOption(_._determineValidFromMessagesOptions(),i),0===c.length?t:void 0)},_updateDescribedBy:p._updateDescribedBy,_addAriaDescribedBy:p._addAriaDescribedBy,_removeAriaDescribedBy:p._removeAriaDescribedBy,_setBusyState:e.EditableValueUtils._SetBusyState,_clearBusyState:e.EditableValueUtils._ClearBusyState,_setBusyStateAsyncValidatorHint:e.EditableValueUtils._SetBusyStateAsyncValidatorHint,_clearBusyStateAsyncValidatorHint:e.EditableValueUtils._ClearBusyStateAsyncValidatorHint,_setBusyStateAsyncConverterLoading:e.EditableValueUtils._SetBusyStateAsyncConverterLoading,_clearBusyStateAsyncConverterLoading:e.EditableValueUtils._ClearBusyStateAsyncConverterLoading,_AfterCreateConverterCached:e.EditableValueUtils._AfterCreateConverterCached,_GetFormControlContainer:function(){if(this._IsCustomElement()){var e="."+[this._GetComponentManagedBaseLabelStyleClass(),"container"].join("-");return this._getRootElement().querySelector(e)}},_IsTextFieldComponent:function(){return!1},_GetComponentManagedBaseLabelStyleClass:function(){return this._IsTextFieldComponent()?"oj-text-field":"oj-form-control"},_CreateMiddleWrapper:function(){var e=document.createElement("div");return e.className="oj-text-field-middle",e},_ResolveLabelEdgeStrategyType:function(){var t=this.options.labelEdge;return this._IsCustomElement()&&"inside"===t&&(this._IsTextFieldComponent()||(t=e.ComponentMessaging._STRATEGY_TYPE.LABEL_EDGE_INSIDE_FORM_CNTRL)),t}},!0),o.setDefaultOptions({editableValue:{displayOptions:o.createDynamicPropertyGetter(function(e){var t={messages:e.containers.indexOf("ojDataGrid")>=0||e.containers.indexOf("ojTable")>=0?["notewindow"]:["inline"],converterHint:["placeholder","notewindow"],validatorHint:["notewindow"]};return t[e.isCustomElement?"helpInstruction":"title"]=["notewindow"],t}),help:o.createDynamicPropertyGetter(function(e){return e.isCustomElement?{instruction:""}:{definition:null,source:null}}),labelEdge:o.createDynamicPropertyGetter(function(e){if(e.isCustomElement)return(a.parseJSONFromFontFamily("oj-form-control-option-defaults")||{}).labelEdge})}}),e.InlineMessagingStrategy=function(e){this.Init(e)},e.ComponentMessaging.registerMessagingStrategy(e.ComponentMessaging._STRATEGY_TYPE.INLINE,e.InlineMessagingStrategy),e.Object.createSubclass(e.InlineMessagingStrategy,e.MessagingStrategy,"oj.InlineMessagingStrategy"),e.InlineMessagingStrategy.prototype.reactivate=function(t){e.InlineMessagingStrategy.superclass.reactivate.call(this,t),this._updateInlineMessage()},e.InlineMessagingStrategy.prototype.shouldUpdate=function(e){return!(!e||void 0===e.validityState)},e.InlineMessagingStrategy.prototype.update=function(){e.InlineMessagingStrategy.superclass.update.call(this),this._updateInlineMessage()},e.InlineMessagingStrategy.prototype.deactivate=function(){this._removeMessagingContentRootDom(),e.InlineMessagingStrategy.superclass.deactivate.call(this)},e.InlineMessagingStrategy.prototype._getDefaultAnimation=function(){if(!e.InlineMessagingStrategy._defaultAnimation){var t=(a.parseJSONFromFontFamily("oj-messaging-inline-option-defaults")||{}).animation;t=t||{},e.InlineMessagingStrategy._defaultAnimation=t}return e.InlineMessagingStrategy._defaultAnimation},e.InlineMessagingStrategy.prototype._replaceAnimationOptions=function(t,i){var s,n;e.StringUtils.isString(t)?(n=!0,s=t+""):(n=!1,s=JSON.stringify(t));for(var a=Object.keys(i),o=0;o<a.length;o++){var l=a[o];s=s.replace(new RegExp(l,"g"),i[l])}return n?s:JSON.parse(s)},e.InlineMessagingStrategy.prototype._determineAnimation=function(e,t){var i,s,n,a=this._getDefaultAnimation();if(a){var o,l=e[0],r=l.innerHTML,u=l.offsetHeight;l.innerHTML=t,o=l.offsetHeight,l.innerHTML=r,"noanimation"!==(i=o>u?"open":o<u?"close":"noanimation")&&(s=a[i])&&(n=this._replaceAnimationOptions(s,{"#oldHeight":u+"px","#newHeight":o+"px"}))}return{action:i,effect:n}},e.InlineMessagingStrategy.prototype._setBusyState=function(){if(!this._resolveBusyState){var e=this.GetComponent(),t=e?e.element:null,i=t?t[0]:null,s=n.getContext(i).getBusyContext(),a="The page is waiting for inline message ";i&&i.id&&(a+='for "'+i.id+'" '),a+="to open/close",this._resolveBusyState=s.addBusyState({description:a})}},e.InlineMessagingStrategy.prototype._clearBusyState=function(){this._resolveBusyState&&(this._resolveBusyState(),this._resolveBusyState=null)},e.InlineMessagingStrategy.prototype._queueAction=function(e){var t=this,i=this.$messagingContentRoot;t._inInlineMessagingAnimation?this._currentContentToShow=e:(this._currentContentToShow=null,this._setBusyState(),this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(function(){if(t._timeoutId=null,i&&i[0]){var s=t._determineAnimation(i,e),n=s.action,a=s.effect;"noanimation"===n?(i[0].innerHTML=e,t._clearBusyState()):("close"===n?i[0].setAttribute("aria-live","off"):i[0].setAttribute("aria-live","polite"),"open"===n&&(i[0].innerHTML=e),t._inInlineMessagingAnimation=!0,l.startAnimation(i[0],"inline-"+n,a,t.GetComponent()).then(function(){var s;t._inInlineMessagingAnimation=!1,"close"===n&&(i[0].setAttribute("aria-live","polite"),i[0].innerHTML=e),null!==t._currentContentToShow?(s=t._currentContentToShow,t._currentContentToShow=null,t._queueAction(s)):t._clearBusyState()}))}else t._clearBusyState()},0))},e.InlineMessagingStrategy.prototype._updateInlineMessage=function(){var e;(e=this._buildInlineHtml())&&null==this.$messagingContentRoot&&this._createInlineMessage(),this.$messagingContentRoot&&this.$messagingContentRoot[0]&&(this.GetComponent()._IsCustomElement()?this._queueAction(e):e?this.$messagingContentRoot[0].innerHTML=e:this._removeMessagingContentRootDom())},e.InlineMessagingStrategy.prototype._createInlineMessage=function(){this.$messagingContentRoot=t(this._getInlineContentHtml()),this._addAriaDescribedBy(this.$messagingContentRoot),this._addAriaLive(this.$messagingContentRoot),this.GetComponent().widget()[0].appendChild(this.$messagingContentRoot[0])},e.InlineMessagingStrategy.prototype._getInlineContentHtml=function(){return"<div class='oj-messaging-inline-container'></div>"},e.InlineMessagingStrategy.prototype._removeMessagingContentRootDom=function(){if(null!=this.$messagingContentRoot){var e=this.$messagingContentRoot[0];this._removeAriaDescribedBy(this.$messagingContentRoot),e.parentNode.removeChild(e),this.$messagingContentRoot=null}},e.InlineMessagingStrategy.prototype._addAriaDescribedBy=function(i){var s,n,a,o,l=(n=this.GetLauncher())[0];e.Assert.assertPrototype(n,t),e.Assert.assertPrototype(i,t),a=i.uniqueId()[0].getAttribute("id"),(o=(s=l.getAttribute("aria-describedby"))?s.split(/\s+/):[]).push(a),null==(s=o.join(" ").trim())?l.removeAttribute("aria-describedby"):l.setAttribute("aria-describedby",s)},e.InlineMessagingStrategy.prototype._addAriaLive=function(i){e.Assert.assertPrototype(i,t),i[0].setAttribute("aria-live","polite")},e.InlineMessagingStrategy.prototype._removeAriaDescribedBy=function(i){var s,n,a,o,l;a=this.GetLauncher(),e.Assert.assertPrototype(a,t),e.Assert.assertPrototype(i,t),o=i[0].getAttribute("id"),-1!==(n=(l=(s=a[0].getAttribute("aria-describedby"))?s.split(/\s+/):[]).indexOf(o))&&l.splice(n,1),(s=l.join(" ").trim())?a[0].setAttribute("aria-describedby",s):a[0].removeAttribute("aria-describedby")},e.InlineMessagingStrategy.prototype._buildInlineHtml=function(){var e;return this.ShowMessages()?(e=this.GetComponent().document[0],this._buildMessagesHtml(e)):""},e.InlineMessagingStrategy.prototype._buildMessagesHtml=function(t){var i,s,n="";return this.HasMessages()&&(s=this.GetMessages(),i=this.GetMaxSeverity(),n=e.PopupMessagingStrategyUtils.buildMessagesHtml(t,s,i,!0)),n};var _=function(e){this.Init(e)};e.ComponentMessaging.registerMessagingStrategy(e.ComponentMessaging._STRATEGY_TYPE.LABEL_EDGE_INSIDE_FORM_CNTRL,_),e.Object.createSubclass(_,e.MessagingStrategy,"InsideFormControlLabelStrategy"),_.prototype.activate=function(e){_.superclass.activate.call(this,e),this._createFixedLabel()},_.prototype.reactivate=function(e){_.superclass.reactivate.call(this,e),this._destroyFixedLabel(),this._createFixedLabel()},_.prototype.shouldUpdate=function(){return!1},_.prototype.update=function(){_.superclass.update.call(this)},_.prototype.deactivate=function(){this._destroyFixedLabel(),_.superclass.deactivate.call(this)},_.prototype.getFormControlLabelStyleClass=function(){return"oj-form-control-label-inside"},_.prototype._destroyFixedLabel=function(){var e=this.GetComponent(),t=e.options,i=e._getRootElement(),s=this.getFormControlLabelStyleClass();i.classList.remove(s),i.removeEventListener("labelHintChanged",this._labelHintChangedCallback),i.removeEventListener("requiredChanged",this._requiredChangedCallback),i.removeEventListener("helpHintsChanged",this._helpHintsChangedCallback);var n=_._getLabelId(i),a=document.getElementById(n);a&&a.parentElement.removeChild(a),t.labelledBy=void 0,this.customOjLabelElement=void 0,delete this._labelHintChangedCallback,delete this._helpHintsChangedCallback,delete this._requiredChangedCallback},_.prototype._createFixedLabel=function(){var e=this.GetComponent(),t=e._GetFormControlContainer();if(t){var i=e.options,s=e._getRootElement(),n=this.getFormControlLabelStyleClass();s.classList.add(n),this.GenerateIdIfNeeded(s);var a=document.createElement("oj-label");a.id=_._getLabelId(s),a.setAttribute("data-oj-binding-provider","none"),a.setAttribute("data-oj-internal",""),a.setAttribute("for",s.id),t.parentElement.insertBefore(a,t);var o=[e._GetDefaultStyleClass(),"label"].join("-");a.classList.add(o),a.showRequired=i.required,a.help=i.helpHints,this.customOjLabelElement=a;var l=document.createElement("span");l.id=[s.id,"|hint"].join(""),l.innerText=i.labelHint,a.appendChild(l),this._labelHintChangedCallback=_._labelHintChangedHandler.bind(this,l),s.addEventListener("labelHintChanged",this._labelHintChangedCallback),this._requiredChangedCallback=_._requiredChangedHandler.bind(this,a),s.addEventListener("requiredChanged",this._requiredChangedCallback),this._helpHintsChangedCallback=_._helpHintsChangedHandler.bind(this,a),s.addEventListener("helpHintsChanged",this._helpHintsChangedCallback)}},_._getLabelId=function(e){return[e.id,"-labelled-by"].join("")},_._labelHintChangedHandler=function(e,t){e.innerText=t.detail.value},_._requiredChangedHandler=function(e,t){e.showRequired=t.detail.value},_._helpHintsChangedHandler=function(e,t){e.help=t.detail.value},e.InsideLabelPlaceholderStrategy=function(e){this.Init(e)},e.Object.createSubclass(e.InsideLabelPlaceholderStrategy,e.MessagingStrategy,"oj.InsideLabelPlaceholderStrategy"),e.InsideLabelPlaceholderStrategy.prototype.activate=function(t){e.InsideLabelPlaceholderStrategy.superclass.activate.call(this,t),this._createPlaceholderToggle()},e.InsideLabelPlaceholderStrategy.prototype.reactivate=function(t){e.InsideLabelPlaceholderStrategy.superclass.reactivate.call(this,t),this._destroyPlaceholderToggle(),this._createPlaceholderToggle()},e.InsideLabelPlaceholderStrategy.prototype.deactivate=function(){this._destroyPlaceholderToggle(),e.InsideLabelPlaceholderStrategy.superclass.deactivate.call(this)},e.InsideLabelPlaceholderStrategy.prototype.shouldUpdate=function(e){return e&&void 0!==e.converterHint||this.GetComponent().options.placeholder},e.InsideLabelPlaceholderStrategy.prototype.update=function(){e.InsideLabelPlaceholderStrategy.superclass.update.call(this),this._placeholderChanged()},e.InsideLabelPlaceholderStrategy.prototype._destroyPlaceholderToggle=function(){var e=this.GetComponent(),t=e._GetContentElement()[0],i=e._getRootElement();this._blurCallback(),t.removeEventListener("focusout",this._blurCallback,!1),delete this._blurCallback,t.removeEventListener("focusin",this._focusCallback,!1),delete this._focusCallback,i.removeEventListener("placeholderChanged",this._placeholderChangedCallback,!1),delete this._placeholderChangedCallback,e._HasPlaceholderSet()&&(e._SetPlaceholder(e.options.placeholder),e._customPlaceholderSet=!0)},e.InsideLabelPlaceholderStrategy.prototype._createPlaceholderToggle=function(){var t=this.GetComponent(),i=t._GetContentElement()[0],s=t._getRootElement();t._customPlaceholderSet=!0,this._blurCallback=e.InsideLabelPlaceholderStrategy._blurHandler.bind(this,i),i.addEventListener("focusout",this._blurCallback,!1),this._focusCallback=e.InsideLabelPlaceholderStrategy._focusHandler.bind(this),i.addEventListener("focusin",this._focusCallback,!1),this._placeholderChangedCallback=this._placeholderChanged.bind(this),s.addEventListener("placeholderChanged",this._placeholderChangedCallback,!1),this._placeholderChanged()},e.InsideLabelPlaceholderStrategy.prototype._placeholderChanged=function(){var t,i=this.GetComponent()._GetContentElement()[0];t=e.FocusUtils.containsFocus(i)?this._focusCallback:this._blurCallback,Promise.resolve(!0).then(function(){t()})},e.InsideLabelPlaceholderStrategy._showConverterHintAsPlaceholder=function(e){var t=e.options.displayOptions;if(!t)return!1;var i=t.converterHint;return i instanceof Array?"placeholder"===i[0]:"placeholder"===i},e.InsideLabelPlaceholderStrategy._focusHandler=function(){var t,i=this.GetComponent();if(e.InsideLabelPlaceholderStrategy._showConverterHintAsPlaceholder(i)){var s=this.GetConverterHint();t=s.length>0?s[0]:null}t||(t=i.options.placeholder),i._SetPlaceholder(t)},e.InsideLabelPlaceholderStrategy._blurHandler=function(t){if(t.hasAttribute("aria-haspopup")){var i=t.getAttribute("aria-owns"),s=document.getElementById(i);if(e.FocusUtils.containsFocus(s))return}var n,a=this.GetComponent();if(e.InsideLabelPlaceholderStrategy._showConverterHintAsPlaceholder(a)){var o=this.GetConverterHint();n=o.length>0?o[0]:null}n||(n=a.options.placeholder),null==n?a._SetPlaceholder(null):a._SetPlaceholder("")},e.InsideLabelStrategy=function(t){this.Init(t),this._placeholderStrategy=new e.InsideLabelPlaceholderStrategy(t)},e.ComponentMessaging.registerMessagingStrategy(e.ComponentMessaging._STRATEGY_TYPE.LABEL_EDGE_INSIDE,e.InsideLabelStrategy),e.Object.createSubclass(e.InsideLabelStrategy,e.MessagingStrategy,"oj.InsideLabelStrategy"),e.InsideLabelStrategy.prototype.activate=function(t){e.InsideLabelStrategy.superclass.activate.call(this,t),this._placeholderStrategy.activate(t),this._createFloatingLabel()},e.InsideLabelStrategy.prototype.reactivate=function(t){e.InsideLabelStrategy.superclass.reactivate.call(this,t),this._destroyFloatingLabel(),this._createFloatingLabel(),this._placeholderStrategy.reactivate(t)},e.InsideLabelStrategy.prototype.shouldUpdate=function(e){return this._placeholderStrategy.shouldUpdate(e)},e.InsideLabelStrategy.prototype.update=function(){this._placeholderStrategy.update()},e.InsideLabelStrategy.prototype.deactivate=function(){this._placeholderStrategy.deactivate(),this._destroyFloatingLabel(),e.InsideLabelStrategy.superclass.deactivate.call(this)},e.InsideLabelStrategy.prototype._destroyFloatingLabel=function(){var t=this.GetComponent()._getRootElement(),i=e.InsideLabelStrategy._getBaseLabelSelector("inside");t.classList.remove(i),t.removeEventListener("labelHintChanged",this._labelHintChangedCallback),t.removeEventListener("valueChanged",this._valueChangedCallback),t.removeEventListener("requiredChanged",this._requiredChangedCallback),t.removeEventListener("validChanged",this._validChangedCallback);var s=e.InsideLabelStrategy._getLabelId(t),n=document.getElementById(s);n&&(n.for="",n.parentElement.removeChild(n)),this.customOjLabelElement=void 0,delete this._labelHintChangedCallback,delete this._valueChangedCallback,delete this._requiredChangedCallback,delete this._validChangedCallback},e.InsideLabelStrategy.prototype._createFloatingLabel=function(){var t=this.GetComponent(),i=t._GetFormControlContainer();if(i){var s="_GetContentWrapper";t[s]&&(i=t[s]());var n=t.options,a=t._getRootElement(),o=e.InsideLabelStrategy._getBaseLabelSelector("inside");a.classList.add(o),this.GenerateIdIfNeeded(a);var l=document.createElement("oj-label");l.id=e.InsideLabelStrategy._getLabelId(a),l.setAttribute("data-oj-binding-provider","none"),l.setAttribute("data-oj-internal",""),l.setAttribute("for",a.id),i.insertBefore(l,i.firstElementChild);var r=[t._GetDefaultStyleClass(),"label"].join("-");l.classList.add(r),l.showRequired=n.required,this.customOjLabelElement=l;var u=document.createElement("span");u.id=[a.id,"|hint"].join(""),u.innerText=n.labelHint,l.appendChild(u),this._labelHintChangedCallback=e.InsideLabelStrategy._labelHintChangedHandler.bind(this,u),a.addEventListener("labelHintChanged",this._labelHintChangedCallback),this._valueChangedCallback=e.InsideLabelStrategy._valueChangedHandler.bind(this,a),a.addEventListener("valueChanged",this._valueChangedCallback),this._requiredChangedCallback=e.InsideLabelStrategy._requiredChangedHandler.bind(this,l),a.addEventListener("requiredChanged",this._requiredChangedCallback),this._validChangedCallback=e.InsideLabelStrategy._validChangedHandler.bind(this,t),a.addEventListener("validChanged",this._validChangedCallback),e.InsideLabelStrategy._toggleHasNoValueSelector(a,t.options.value)}},e.InsideLabelStrategy._getBaseLabelSelector=function(t){return[e.InsideLabelStrategy._BASE_STYLE_CLASS,"label",t.toLowerCase()].join("-")},e.InsideLabelStrategy._getLabelId=function(e){return[e.id,"-labelled-by"].join("")},e.InsideLabelStrategy._labelHintChangedHandler=function(e,t){e.innerText=t.detail.value},e.InsideLabelStrategy._requiredChangedHandler=function(e,t){e.showRequired=t.detail.value},e.InsideLabelStrategy._validChangedHandler=function(t,i){if("invalidShown"===i.detail.value){var s=t._GetDisplayValue(),n=t._getRootElement();e.InsideLabelStrategy._toggleHasNoValueSelector(n,s)}},e.InsideLabelStrategy._valueChangedHandler=function(t,i){e.InsideLabelStrategy._toggleHasNoValueSelector(t,i.detail.value)},e.InsideLabelStrategy._toggleHasNoValueSelector=function(t,i){var s;null==(s=i)||("string"==typeof s?e.StringUtils.isEmptyOrUndefined(s):"number"==typeof s?isNaN(s):Array.isArray(s)&&(0===s.length||1===s.length&&(null===s[0]||void 0===s[0])))?t.classList.add(e.InsideLabelStrategy._HAS_NO_VALUE_MARKER_CLASS):t.classList.remove(e.InsideLabelStrategy._HAS_NO_VALUE_MARKER_CLASS)},e.InsideLabelStrategy._HAS_NO_VALUE_MARKER_CLASS="oj-has-no-value",e.InsideLabelStrategy._BASE_STYLE_CLASS="oj-text-field",e.PopupMessagingStrategy=function(e){this.Init(e)},e.ComponentMessaging.registerMessagingStrategy(e.ComponentMessaging._STRATEGY_TYPE.NOTEWINDOW,e.PopupMessagingStrategy),e.Object.createSubclass(e.PopupMessagingStrategy,e.MessagingStrategy,"oj.PopupMessagingStrategy"),e.PopupMessagingStrategy._DEFAULTS_BY_COMPONENT={ojRadioset:{position:"launcher",events:{open:"focusin mouseenter press",close:"mouseleave"}},ojCheckboxset:{position:"launcher",events:{open:"focusin mouseenter press",close:"mouseleave"}},ojInputText:{position:"launcher",events:{open:"focusin"}},ojTextArea:{position:"launcher",events:{open:"focusin"}},ojInputPassword:{position:"launcher",events:{open:"focusin"}},ojSwitch:{position:"launcher",events:{open:"focusin mouseenter",close:"mouseleave"}},ojSlider:{position:"launcher",events:{open:"focusin mouseenter",close:"mouseleave"}},ojColorSpectrum:{position:"launcher",events:{open:"focusin mouseenter",close:"mouseleave"}},ojColorPalette:{position:"launcher",events:{open:"focusin mouseenter",close:"mouseleave"}},default:{position:"launcher-wrapper",events:{open:"focusin"}}},e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT="oj-form-control-hint",e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT_CONVERTER="oj-form-control-hint-converter",e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT_VALIDATOR="oj-form-control-hint-validator",e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT_TITLE="oj-form-control-hint-title",e.PopupMessagingStrategy._OPEN_NAMESPACE=".ojPopupMessagingOpen",e.PopupMessagingStrategy._CLOSE_NAMESPACE=".ojPopupMessagingClose",e.PopupMessagingStrategy.prototype.activate=function(t){e.PopupMessagingStrategy.superclass.activate.call(this,t),this._initMessagingPopup()},e.PopupMessagingStrategy.prototype.reactivate=function(t){e.PopupMessagingStrategy.superclass.reactivate.call(this,t),this._updatePopupIfOpenOrComponentHasFocus()},e.PopupMessagingStrategy.prototype.update=function(){e.PopupMessagingStrategy.superclass.update.call(this),this._updatePopupIfOpenOrComponentHasFocus()},e.PopupMessagingStrategy.prototype.deactivate=function(){this._unregisterLauncherEvents(),this._destroyTooltip(),e.PopupMessagingStrategy.superclass.deactivate.call(this)},e.PopupMessagingStrategy.prototype.close=function(){this._closePopup()},e.PopupMessagingStrategy.prototype.GetValidatorHints=function(){var e=this.GetComponent();!e._initAsyncMessaging&&e&&e._initAsyncValidatorMessagingHint&&(e._initAsyncMessaging=!0,e._initAsyncValidatorMessagingHint());var i=[],s=this._getMessagingContent(),n=s&&s.validatorHint||[];return t.each(n,function(e,t){i.push(t)}),i},e.PopupMessagingStrategy.prototype._closePopup=function(){this._queueAction(function(e){if(this._isPopupInitialized())return e&&this._setActionResolver(this.$messagingContentRoot,"close",e),void this.$messagingContentRoot.ojPopup("close");e&&e(!0)}.bind(this))},e.PopupMessagingStrategy.prototype._initMessagingPopup=function(){this._openPopupCallback||this._registerLauncherEvents()},e.PopupMessagingStrategy.prototype._addAnimateEventListeners=function(e){var t=function(e,t,i){var s=this.GetComponent();s&&s._trigger&&(t.stopPropagation(),s._trigger(e,null,i)||t.preventDefault())};e.on("ojanimatestart.notewindow",t.bind(this,"animateStart")),e.on("ojanimateend.notewindow",t.bind(this,"animateEnd"))},e.PopupMessagingStrategy.prototype._removeAnimateEventListeners=function(e){e.off("ojanimatestart.notewindow"),e.off("ojanimateend.notewindow")},e.PopupMessagingStrategy.prototype._setBusyState=function(e){var t=this.GetComponent(),i=t?t.element:null,s=i?i[0]:null,a=n.getContext(s).getBusyContext(),o="The page is waiting for note window ";return s&&s.id&&(o+='for "'+s.id+'" '),o+="to "+e,a.addBusyState({description:o})},e.PopupMessagingStrategy.prototype._setActionResolver=function(e,t,i){var s;this._actionCount>1&&(s=e.ojPopup("option","animation"),e.ojPopup("option","animation",null));var n=this._setBusyState(t);e.one("oj"+t,function(){s&&e.ojPopup("option","animation",s),n(),i(!0)})},e.PopupMessagingStrategy.prototype._queueAction=function(e){if(this.GetComponent()._IsCustomElement()){var t=this,i=function(e){var i=new Promise(e);return i.then(function(){t._actionCount-=1}),i};this._actionCount?(this._actionCount+=1,this._actionPromise=this._actionPromise.then(function(){return i(e)})):(this._actionCount=1,this._actionPromise=i(e))}else e(null)},e.PopupMessagingStrategy.prototype._openPopup=function(t){this._queueAction(function(i){var s,n,a;if(this._canOpenPopup()&&(n=this._buildPopupHtml(),!e.StringUtils.isEmptyOrUndefined(n))){var o=this._getPopupElement(),l=o.ojPopup("isOpen");if((s=e.PopupMessagingStrategyPoolUtils.getPopupContentNode(o)).innerHTML="",s.innerHTML=n,!l)return a=this.GetLauncher(),t&&"press"===t.type&&this._openPopupOnPressEvent(a),i&&this._setActionResolver(o,"open",i),void o.ojPopup("open",a);l&&o.ojPopup("refresh")}i&&i(!0)}.bind(this))},e.PopupMessagingStrategy.prototype._openPopupOnPressEvent=function(e){this._inPressEvent=!0,e[0].addEventListener("click",this._eatChangeAndClickOnPress,!0),e[0].addEventListener("change",this._eatChangeAndClickOnPress,!0),e.one("touchend",function(){setTimeout(function(){this._inPressEvent=!1},50)})},e.PopupMessagingStrategy.prototype._eatChangeAndClickOnPress=function(e){this._inPressEvent&&(e.preventDefault(),e.stopPropagation(),"click"===e.type&&(this._inPressEvent=!1))},e.PopupMessagingStrategy.prototype._canOpenPopup=function(){var e=this.GetComponent().options,t=e.disabled||!1,i=e.readOnly||!1;return!(t||i)},e.PopupMessagingStrategy.prototype._updatePopupIfOpenOrComponentHasFocus=function(){var t,i,s,n;t=this._buildPopupHtml(),null!=this.GetLauncher()&&(s=this.GetLauncher()[0].contains(document.activeElement),this._isPopupInitialized()?(n=this._getPopupElement()).ojPopup("isOpen")&&(t?((i=e.PopupMessagingStrategyPoolUtils.getPopupContentNode(n)).innerHTML="",i.innerHTML=t,n.ojPopup("refresh")):n.ojPopup("close")):s&&t&&this._openPopup(void 0))},e.PopupMessagingStrategy.prototype._unregisterLauncherEvents=function(){var t=this.GetLauncher();t.off(e.PopupMessagingStrategy._OPEN_NAMESPACE),t.off(e.PopupMessagingStrategy._CLOSE_NAMESPACE),t[0].removeEventListener("click",this._eatChangeAndClickOnPress,!0),t[0].removeEventListener("change",this._eatChangeAndClickOnPress,!0),e.DomUtils.isTouchSupported()&&(t.ojHammer().off("press"),t.ojHammer("destroy"),t.off("contextmenu",this._eatContextMenuOnOpenPopupListener),this._eatContextMenuOnOpenPopupListener=null,this._inPressEvent=null),this._openPopupCallback=null,this._closePopupCallback=null},e.PopupMessagingStrategy.prototype._registerLauncherEvents=function(){var t,s,n,a,o,l,r,u,d=this.GetLauncher();(a=(n=e.PopupMessagingStrategy._DEFAULTS_BY_COMPONENT[this.GetComponent().widgetName])?n.events:e.PopupMessagingStrategy._DEFAULTS_BY_COMPONENT.default.events).open&&((r=this._openPopupCallback)||(r=this._openPopup.bind(this),this._openPopupCallback=r),u=a.open.indexOf("press"),l=this._getNamespacedEvents(a.open.replace("press",""),e.PopupMessagingStrategy._OPEN_NAMESPACE),d.on(l,r),e.DomUtils.isTouchSupported()&&-1!==u&&(this._eatContextMenuOnOpenPopupListener=function(){return!1},d.on("contextmenu",this._eatContextMenuOnOpenPopupListener),o={recognizers:[[i.Press,{time:750}]]},d.ojHammer(o).on("press",r))),a.close&&((s=this._closePopupCallback)||(s=this._closePopup.bind(this),this._closePopupCallback=s),t=this._getNamespacedEvents(a.close,e.PopupMessagingStrategy._CLOSE_NAMESPACE),d.on(t,s))},e.PopupMessagingStrategy.prototype._getNamespacedEvents=function(e,t){var i,s,n;if(""===e||""===t)return e;n=(i=e.split(" ")).length,s=[];for(var a=0;a<n;a++)i[a]&&s.push(i[a]+t);return s.join(" ")},e.PopupMessagingStrategy.prototype._getPopupPosition=function(){var t,i,s;return(t=(i=e.PopupMessagingStrategy._DEFAULTS_BY_COMPONENT[this.GetComponent().widgetName])?i.position:e.PopupMessagingStrategy._DEFAULTS_BY_COMPONENT.default.position)&&("launcher"===t?s=this.GetLauncher():"launcher-wrapper"===t&&(s=this.GetLauncher().parent())),s||(s=this.GetComponent().widget()),{my:"start bottom",at:"end top",collision:"flipcenter",of:s}},e.PopupMessagingStrategy.prototype._getPopupElement=function(){var t,i;if(this.$messagingContentRoot)return this.$messagingContentRoot;if(t=e.PopupMessagingStrategyPoolUtils.getNextFreePopup(),i=this._getPopupPosition(),t.ojPopup("option","position",i),t.ojPopup("option","beforeClose",this._popupBeforeCloseCallback.bind(this)),t.ojPopup("option","close",this._popupCloseCallback.bind(this)),t.ojPopup("option","open",this._popupOpenCallback.bind(this)),this.GetComponent()._IsCustomElement()){var s=(a.parseJSONFromFontFamily("oj-messaging-popup-option-defaults")||{}).animation;s.actionPrefix="notewindow",t.ojPopup("option","animation",s),this._addAnimateEventListeners(t)}else t.ojPopup("option","animation",null);return this.$messagingContentRoot=t,this.$messagingContentRoot},e.PopupMessagingStrategy.prototype._popupOpenCallback=function(e){var i=t(e.target),s=this;window.setTimeout(function(){o.isComponentInitialized(i,"ojPopup")?i.ojPopup("option","autoDismiss","focusLoss"):delete s.$messagingContentRoot},10)},e.PopupMessagingStrategy.prototype._popupBeforeCloseCallback=function(){this._resolveBusyState=this._setBusyState("close")},e.PopupMessagingStrategy.prototype._popupCloseCallback=function(i){var s=this.GetLauncher(),n=t(i.target);this._removeAnimateEventListeners(n),o.isComponentInitialized(n,"ojPopup")&&(n.ojPopup("option","autoDismiss","none"),n.ojPopup("option","open",null),n.ojPopup("option","close",null),n.ojPopup("option","beforeClose",null)),s&&s[0]&&(s[0].removeEventListener("click",this._eatChangeAndClickOnPress,!0),s[0].removeEventListener("change",this._eatChangeAndClickOnPress,!0)),this.$messagingContentRoot=null,this._inPressEvent=null,e.PopupMessagingStrategyPoolUtils.getPopupContentNode(n).innerHTML="",this._resolveBusyState&&(this._resolveBusyState(),this._resolveBusyState=null)},e.PopupMessagingStrategy.prototype._destroyTooltip=function(){this._closePopup(),e.PopupMessagingStrategyPoolUtils.destroyFreePopup()},e.PopupMessagingStrategy.prototype._buildPopupHtml=function(){var t=!1,i=this.GetComponent().document[0],s=[],n="";return this.ShowMessages()&&s.push(this._buildMessagesHtml(i)),(this.ShowConverterHint()||this.ShowValidatorHint()||this.ShowTitle())&&s.push(this._buildHintsHtml(i)),s.forEach(function(s){s&&(t?n=n.concat(e.PopupMessagingStrategyUtils.getSeparatorHtml(i)):t=!0,n=n.concat(s))}),n},e.PopupMessagingStrategy.prototype._buildMessagesHtml=function(t){var i,s="",n=this.GetMaxSeverity();return this.HasMessages()&&(i=this.GetMessages(),s=e.PopupMessagingStrategyUtils.buildMessagesHtml(t,i,n,!1)),s},e.PopupMessagingStrategy.prototype._buildHintsHtml=function(t){var i,s,n=[],a="";if(this.ShowConverterHint()&&(i=(n=this.GetConverterHint()).length?n[0]:"",a+=e.PopupMessagingStrategyUtils.buildHintHtml(t,e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT_CONVERTER,i,!1,e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT)),this.ShowValidatorHint())for(n=this.GetValidatorHints(),s=0;s<n.length;s++)a+=e.PopupMessagingStrategyUtils.buildHintHtml(t,e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT_VALIDATOR,n[s],!1,e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT);return this.ShowTitle()&&(a+=e.PopupMessagingStrategyUtils.buildHintHtml(t,e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT_TITLE,this.GetTitle(),!0,e.PopupMessagingStrategy._SELECTOR_FORMCONTROL_HINT)),a?"<div class='oj-form-control-hints'>"+a+"</div>":""},e.PopupMessagingStrategy.prototype._isPopupInitialized=function(){return!!this.$messagingContentRoot&&o.isComponentInitialized(this.$messagingContentRoot,"ojPopup")},e.PopupMessagingStrategyUtils={},e.PopupMessagingStrategyUtils.buildHintHtml=function(t,i,s,n,a){var o;if(s){o=t.createElement("div");for(var l=a.split(" "),r=0,u=l.length;r<u;++r)o.classList.add(l[r]);o.classList.add(i),e.PopupMessagingStrategyUtils._appendTextDom(o,e.PopupMessagingStrategyUtils._getTextDom(t,s,n))}return o?o.outerHTML:""},e.PopupMessagingStrategyUtils.getSeverityTranslatedString=function(e){var t;switch(e){case r.SEVERITY_LEVEL.FATAL:t=s.getTranslatedString("oj-message.fatal");break;case r.SEVERITY_LEVEL.ERROR:t=s.getTranslatedString("oj-message.error");break;case r.SEVERITY_LEVEL.WARNING:t=s.getTranslatedString("oj-message.warning");break;case r.SEVERITY_LEVEL.INFO:t=s.getTranslatedString("oj-message.info");break;case r.SEVERITY_LEVEL.CONFIRMATION:t=s.getTranslatedString("oj-message.confirmation")}return t},e.PopupMessagingStrategyUtils.getSeparatorHtml=function(e){var i;return(i=t(e.createElement("hr")))?i.get(0).outerHTML:""},e.PopupMessagingStrategyUtils.buildMessagesHtml=function(t,i,s,n){var a,o,l,u,d,g,p,h,_="",c=[],S={};for(o=0;o<i.length;o++)d=(u=i[o])instanceof r?u:new r(u.summary,u.detail,u.severity),S[g=r.getSeverityLevel(d.severity)]||(S[g]=[]),S[g].push(d);for(o=s;o>=r.SEVERITY_LEVEL.CONFIRMATION;o--)for(c=S[o]||[],l=0;l<c.length;l++)u=c[l],g=r.getSeverityLevel(u.severity),p=e.PopupMessagingStrategyUtils.getSeverityTranslatedString(g),h=u.summary||p,a=u.detail||"",_=_.concat(e.PopupMessagingStrategyUtils.buildMessageHtml(t,h,a,g,n));return _},e.PopupMessagingStrategyUtils.buildMessageHtml=function(t,i,s,n,a){var o,l,r,u,d,g=e.PopupMessagingStrategyUtils.getSeverityTranslatedString(n);if((r=t.createElement("div")).classList.add(e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE),a)for(var p=e.PopupMessagingStrategyUtils._getSeveritySelector(n).split(" "),h=0,_=p.length;h<_;++h)r.classList.add(p[h]);u=t.createElement("span");for(var c=e.PopupMessagingStrategyUtils._getSeverityIconSelector(n).split(" "),S=0,m=c.length;S<m;++S)u.classList.add(c[S]);if(null==g?u.removeAttribute("title"):u.setAttribute("title",g),u.setAttribute("role","img"),r.appendChild(u),(o=t.createElement("span")).classList.add(e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_CONTENT),(d=t.createElement("div")).classList.add(e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_SUMMARY),d.textContent=i,o.appendChild(d),s){var v=e.PopupMessagingStrategyUtils._getTextDom(t,s,!0);(l=t.createElement("div")).classList.add(e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_DETAIL),e.PopupMessagingStrategyUtils._appendTextDom(l,v),o.appendChild(l)}return r.appendChild(o),r.outerHTML},e.PopupMessagingStrategyUtils._getSeverityIconSelector=function(t){var i;switch(t){case r.SEVERITY_LEVEL.FATAL:case r.SEVERITY_LEVEL.ERROR:i=e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_ERROR_ICON;break;case r.SEVERITY_LEVEL.WARNING:i=e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_WARNING_ICON;break;case r.SEVERITY_LEVEL.INFO:i=e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_INFO_ICON;break;case r.SEVERITY_LEVEL.CONFIRMATION:i=e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_CONFIRMATION_ICON}return e.PopupMessagingStrategyUtils._DEFAULT_STATUS_ICON_SELECTORS+i},e.PopupMessagingStrategyUtils._getSeveritySelector=function(t){var i;switch(t){case r.SEVERITY_LEVEL.FATAL:case r.SEVERITY_LEVEL.ERROR:i=e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_ERROR;break;case r.SEVERITY_LEVEL.WARNING:i=e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_WARNING;break;case r.SEVERITY_LEVEL.INFO:i=e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_INFO;break;case r.SEVERITY_LEVEL.CONFIRMATION:default:i=e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_CONFIRMATION}return i},e.PopupMessagingStrategyUtils._getTextDom=function(t,i,s){var n=null;return e.StringUtils.isString(i)&&(s&&e.DomUtils.isHTMLContent(i)?n=e.DomUtils.cleanHtml(i.substring(6,i.length-7)):(n=t.createElement("span")).textContent=i),n},e.PopupMessagingStrategyUtils._appendTextDom=function(t,i){e.StringUtils.isString(i)?t.innerHTML=i:t.appendChild(i)},e.PopupMessagingStrategyUtils._DEFAULT_STATUS_ICON_SELECTORS="oj-component-icon oj-message-status-icon ",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE="oj-message",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_SUMMARY="oj-message-summary",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_DETAIL="oj-message-detail",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_CONTENT="oj-message-content",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_ERROR_ICON="oj-message-error-icon",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_WARNING_ICON="oj-message-warning-icon",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_INFO_ICON="oj-message-info-icon",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_CONFIRMATION_ICON="oj-message-confirmation-icon",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_ERROR="oj-message-error",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_WARNING="oj-message-warning",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_INFO="oj-message-info",e.PopupMessagingStrategyUtils._SELECTOR_MESSAGE_CONFIRMATION="oj-message-confirmation",e.PopupMessagingStrategyPoolUtils={},e.PopupMessagingStrategyPoolUtils.getNextFreePopup=function(){var i,s=e.PopupMessagingStrategyPoolUtils._getPool(),n=s.find("."+e.PopupMessagingStrategyPoolUtils._SELECTOR_MESSAGING);if(0===n.length){(i=t(e.PopupMessagingStrategyPoolUtils._getPopupContentHtml()))[0].style.display="none",i.appendTo(s);i.ojPopup({initialFocus:"none",tail:"simple",autoDismiss:"none",modality:"modeless",animation:{open:null,close:null}})}else i=t(n[0]);return i},e.PopupMessagingStrategyPoolUtils.getPopupContentNode=function(t){return t.find("."+e.PopupMessagingStrategyPoolUtils._SELECTOR_MESSAGING_CONTAINER)[0]},e.PopupMessagingStrategyPoolUtils.destroyFreePopup=function(){var t;if(e.PopupMessagingStrategyPoolUtils._getFreePoolCount()>0){var i=(t=e.PopupMessagingStrategyPoolUtils.getNextFreePopup())[0];t.ojPopup("destroy"),i.parentNode.removeChild(i)}},e.PopupMessagingStrategyPoolUtils._getPool=function(){var i=t("#"+e.PopupMessagingStrategyPoolUtils._MESSAGING_POPUP_POOL_ID);if(i.length>0)return i;var s=(i=t("<div>"))[0];return s.setAttribute("id",e.PopupMessagingStrategyPoolUtils._MESSAGING_POPUP_POOL_ID),s.setAttribute("role","presentation"),document.body.appendChild(s),i},e.PopupMessagingStrategyPoolUtils._getFreePoolCount=function(){return e.PopupMessagingStrategyPoolUtils._getPool().find("."+e.PopupMessagingStrategyPoolUtils._SELECTOR_MESSAGING).length},e.PopupMessagingStrategyPoolUtils._getPopupContentHtml=function(){return'<div class="'+e.PopupMessagingStrategyPoolUtils._SELECTOR_MESSAGING+'"><div class="'+e.PopupMessagingStrategyPoolUtils._SELECTOR_MESSAGING_CONTAINER+'"></div></div>'},e.PopupMessagingStrategyPoolUtils._SELECTOR_MESSAGING_CONTAINER="oj-messaging-popup-container",e.PopupMessagingStrategyPoolUtils._SELECTOR_MESSAGING="oj-messaging-popup",e.PopupMessagingStrategyPoolUtils._MESSAGING_POPUP_POOL_ID="__oj_messaging_popup_pool"});